---
title: 前端性能优化
date: 2020 07 08
categories:
    - web
    - Q/A

tags:
    - web
---

### 导图

![导图](/images/better.jpg)

### DNS

-

```html
<!--  link  dns与解析 -->
<link rel="dns-prefetch" />
<!-- 安全防范 ，新开页面 window.openner=null  -->
<a target="_blank" rel="noopener"></a>
```

### 网络请求

-   减少 http 的请求次数，将多个请求合并成同一个，减少 http 的开销
-   base64 图片 / iconfonts
-   CDN 分发静态资源
-   后台开启 Gzip 压缩
-   浏览器缓存策略
-   应用储存: service worker/ localstorage

### 浏览器渲染

-   DOM

    -   避免深层次嵌套
    -   语义化标签 img 加 alt
    -   尽量避免回流 ( 例如:动态添加多个子元素时,先创建一个容器,向容器中添加子节点,最后再将容器 append 进文档流中 dispay:none 再回复 dislay , 图片给宽高)

-   Css

    -   避免深层级嵌套
    -   animation / transform
    -   使用 link 代替 @import(页面加载完成后加载， 阻塞 render tree)
    -   不要一条条地改变样式，而要通过改变 class，或者 csstext 属性，一次性地改变样式。

-   js

    -   async(并行，立即解析) | defer(并行，延迟解析) | [html 中 script 位置问题](#Q1)
    -   事件代理
    -   必须 js 控制动画时使用 requestAnimationFrame
    -   按需引入| 懒加载 | 预加载
    -   防抖 /节流

### webpack 层面

-   开发环境
    -   打包构建速度(HMR)
    -   代码调试(source-map)
-   生产环境

    -   打包构建速度
        -   使用 oneof
        -   babel 缓存
        -   多进程打包
        -   externals
        -   dll
    -   代码运行性能
        -   缓存(hash-chunkhash-contenthash)
        -   tree shaking
        -   code split
        -   懒加载 / 预加载
        -   pwa

### Q1

-   Q:分别使用 1,2 网页怎么显示?

```html
<!-- html -->
<div class="" id="">
    hello
</div>

<!-- css -->

<style>
    html,
    body {
        width: 100%;
        height: 100%;
        background-color: aqua;
    }
</style>
<!-- 1 -->
<script src="./index.js"></script>
<!-- 2 -->
<!-- <script>
    while (true) {}
</script> -->
```

-   结论 : 第一种方式页面渲染出元素和样式,但是页面卡死 , 第二种页面直接白屏并且卡死,即未渲染
-   浏览器渲染是分帧进行的 ,如果在某一帧内 js 代码阻塞,同一帧内的 dom 也不会渲染
